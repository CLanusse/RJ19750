(this["webpackJsonpcoder-rj-profe"]=this["webpackJsonpcoder-rj-profe"]||[]).push([[0],{56:function(e,t,c){},61:function(e,t,c){},62:function(e,t,c){},80:function(e,t,c){"use strict";c.r(t);var n=c(4),a=c.n(n),r=c(44),i=c.n(r),o=c(7),s=c(13),l=c(8),j=c(3),d=Object(n.createContext)(),b=function(e){var t=e.children,c=Object(n.useState)(!1),a=Object(s.a)(c,2),r=a[0],i=a[1];return Object(j.jsx)(d.Provider,{value:{loading:r,setLoading:i},children:t})},u=c(32),h=(c(38),u.a.initializeApp({apiKey:"AIzaSyCGw1jFirx32U89ATJVZt5oSpom8zOKRRQ",authDomain:"coder-rj-19750.firebaseapp.com",projectId:"coder-rj-19750",storageBucket:"coder-rj-19750.appspot.com",messagingSenderId:"217968586573",appId:"1:217968586573:web:1bad3cb68c5a2d508d1104"})),O=function(){return u.a.firestore(h)},x=(c(56),function(){return Object(j.jsx)("div",{className:"loader",children:Object(j.jsx)("h2",{children:"Cargando..."})})}),m=c(82),f=c(83),p=c(15),g=function(e){var t=e.id,c=e.name,n=e.price,a=e.img,r=e.description,i=e.category;return Object(j.jsxs)(m.a,{style:{width:"18rem"},className:"m-3",children:[Object(j.jsx)(m.a.Img,{variant:"top",src:a}),Object(j.jsxs)(m.a.Body,{children:[Object(j.jsx)(m.a.Title,{children:c}),Object(j.jsx)(m.a.Text,{children:r}),Object(j.jsxs)(m.a.Text,{children:["Precio: $",n]}),Object(j.jsxs)(m.a.Text,{children:["Categoria: ",i]}),Object(j.jsx)(p.b,{to:"/detail/".concat(t),children:Object(j.jsx)(f.a,{variant:"primary",children:"Lo quiero"})})]})]})},v=function(e){var t=e.productos,c=void 0===t?[]:t;return Object(j.jsxs)("div",{className:"container",children:[Object(j.jsx)("h2",{children:"Nuestros productos"}),Object(j.jsx)("hr",{}),Object(j.jsx)("div",{className:"row",children:c.map((function(e){return Object(n.createElement)(g,Object(o.a)(Object(o.a)({},e),{},{key:e.id}))}))})]})},C=function(){var e=Object(n.useState)([]),t=Object(s.a)(e,2),c=t[0],a=t[1],r=Object(n.useContext)(d),i=r.loading,b=r.setLoading,u=Object(l.h)().categoryId;return Object(n.useEffect)((function(){b(!0);var e=O();(u?e.collection("productos").where("category","==",u):e.collection("productos")).get().then((function(e){var t=e.docs.map((function(e){return Object(o.a)({id:e.id},e.data())}));a(t)})).catch((function(e){return console.log(e)})).finally((function(){b(!1)}))}),[u,b]),Object(j.jsx)("section",{className:"container my-5",children:i?Object(j.jsx)(x,{}):Object(j.jsx)(v,{productos:c})})},y=c(50),N=Object(n.createContext)(),k=JSON.parse(localStorage.getItem("carrito"))||[],I=function(e){var t=e.children,c=Object(n.useState)(k),a=Object(s.a)(c,2),r=a[0],i=a[1];console.log(r);return Object(n.useEffect)((function(){localStorage.setItem("carrito",JSON.stringify(r))}),[r]),Object(j.jsx)(N.Provider,{value:{carrito:r,addToCart:function(e){i([].concat(Object(y.a)(r),[e]))},removeItem:function(e){var t=r.filter((function(t){return t.id!==e}));i(t)},calcularCantidad:function(){return r.reduce((function(e,t){return e+t.cantidad}),0)},vaciarCarrito:function(){i([])},isInCart:function(e){return r.some((function(t){return t.id===e}))},calcularTotal:function(){return r.reduce((function(e,t){return e+t.cantidad*t.price}),0)}},children:t})},T=function(e){var t=e.cantidad,c=e.modify,n=e.max;return Object(j.jsxs)("div",{children:[Object(j.jsx)("button",{onClick:function(){t>0&&c(t-1)},className:"btn ".concat(0===t?"btn-danger desactivado":"btn-primary"),children:"-"}),Object(j.jsx)("span",{className:"mx-3",children:t}),Object(j.jsx)("button",{onClick:function(){t<n&&c(t+1)},className:"btn ".concat(t===n?"btn-danger desactivado":"btn-primary"),children:"+"})]})},S=(c(61),function(e){var t=e.id,c=e.name,a=e.price,r=e.img,i=e.description,o=e.category,d=e.stock,b=Object(l.g)(),u=b.goBack,h=b.push,O=Object(n.useContext)(N),x=O.addToCart,m=O.isInCart,f=Object(n.useState)(0),g=Object(s.a)(f,2),v=g[0],C=g[1],y={btnAgregar:m(t)?"btn btn-danger m-2":"btn btn-success m-2",btnTerminar:"btn btn-success ".concat(!m(t)&&"desactivado")};return Object(j.jsxs)("div",{className:"container",children:[Object(j.jsx)("h2",{children:c}),Object(j.jsx)("img",{src:r,alt:c}),Object(j.jsx)("p",{children:i}),Object(j.jsxs)("h4",{children:["Precio: $",a]}),Object(j.jsxs)("div",{className:m(t)&&"desactivado",children:[Object(j.jsx)(T,{cantidad:v,modify:C,max:d}),Object(j.jsx)("button",{disabled:0===v,className:y.btnAgregar,onClick:function(){v>0&&x({id:t,name:c,price:a,category:o,cantidad:v})},children:"Agregar"})]}),Object(j.jsx)(p.b,{to:"/cart",className:y.btnTerminar,children:"Terminar mi compra"}),Object(j.jsx)("hr",{}),Object(j.jsx)("button",{className:"btn btn-primary",onClick:function(){return u()},children:"Volver"}),Object(j.jsx)("button",{className:"btn btn-outline-primary mx-4",onClick:function(){return h("/")},children:"Volver al inicio"})]})}),w=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),c=t[0],a=t[1],r=Object(n.useContext)(d),i=r.loading,b=r.setLoading,u=Object(l.h)().itemId;return Object(n.useEffect)((function(){b(!0),O().collection("productos").doc(u).get().then((function(e){a(Object(o.a)({id:e.id},e.data()))})).catch((function(e){return console.log(e)})).finally((function(){b(!1)}))}),[u,b]),Object(j.jsx)("div",{children:i?Object(j.jsx)(x,{}):Object(j.jsx)(S,Object(o.a)({},c))})},P=Object(n.createContext)(),A=function(e){var t=e.children,c=Object(n.useState)(!1),a=Object(s.a)(c,2),r=a[0],i=a[1];return Object(j.jsx)(P.Provider,{value:{isAuthenticated:r,setIsAuthenticated:i},children:t})},F=c(47),E=function(){var e=Object(n.useContext)(N).calcularCantidad;return Object(j.jsxs)("div",{style:{visibility:0===e()?"hidden":"visible"},children:[Object(j.jsx)(F.a,{className:"widget"}),Object(j.jsx)("span",{children:e()})]})},L=(c(62),function(e){var t=e.logo,c=Object(n.useContext)(P),a=c.isAuthenticated,r=c.setIsAuthenticated;return Object(j.jsxs)("header",{className:"header",children:[Object(j.jsx)("h1",{children:t}),Object(j.jsx)("div",{children:Object(j.jsxs)("nav",{children:[Object(j.jsx)(p.c,{activeClassName:"activeLink",exact:!0,to:"/",children:"Inicio"}),Object(j.jsx)(p.c,{activeClassName:"activeLink",exact:!0,to:"/productos/remeras",children:"Remeras"}),Object(j.jsx)(p.c,{activeClassName:"activeLink",exact:!0,to:"/productos/zapatos",children:"Zapatos"}),Object(j.jsx)(p.c,{activeClassName:"activeLink",exact:!0,to:"/contacto",children:"Contacto"}),Object(j.jsx)(p.b,{to:"/cart",children:Object(j.jsx)(E,{})}),!a||Object(j.jsx)("button",{onClick:function(){r(!1)},children:" Salir"})]})})]})}),z=(c(63),c(48)),B=function(){var e=Object(n.useContext)(N),t=e.carrito,c=e.vaciarCarrito,a=e.removeItem,r=e.calcularTotal;return Object(j.jsx)("div",{className:"container my-5",children:0===t.length?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h2",{children:"No hay productos agregados"}),Object(j.jsx)(p.b,{to:"/",className:"btn btn-success",children:"Ir a comprar"})]}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("h2",{children:"Resumen de compra"}),Object(j.jsx)("hr",{}),t.map((function(e){return Object(j.jsxs)("div",{children:[Object(j.jsx)("h4",{children:e.name}),Object(j.jsxs)("p",{children:["Cantidad: ",e.cantidad]}),Object(j.jsxs)("p",{children:["Precio: ",e.price*e.cantidad]}),Object(j.jsx)("button",{className:"btn btn-danger",onClick:function(){return a(e.id)},children:Object(j.jsx)(z.a,{})})]})})),Object(j.jsx)("hr",{}),Object(j.jsxs)("h3",{className:"my-3",children:["Precio total: $",r()]}),Object(j.jsx)("button",{className:"btn btn-danger",onClick:c,children:"Vaciar carrito"}),Object(j.jsx)(p.b,{to:"/checkout",className:"btn btn-success mx-3",children:"Terminar mi compra"})]})})},D=function(){var e=Object(n.useContext)(P).setIsAuthenticated;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"container",children:[Object(j.jsx)("h2",{children:"Por favor logueate."}),Object(j.jsx)("hr",{}),Object(j.jsx)("div",{className:"row",children:Object(j.jsx)("button",{onClick:function(){e(!0)},children:" Login "})})]})})},J=c(27),R=c(35),V=c.n(R),$=c(36),G=c.n($),K=c(49),Z=c(37),q=function(){var e=Object(n.useContext)(d),t=e.loading,c=e.setLoading,a=Object(n.useContext)(N),r=a.carrito,i=a.calcularTotal,b=a.vaciarCarrito,u=Object(n.useState)({nombre:"",apellido:"",email:"",tel:""}),h=Object(s.a)(u,2),m=h[0],f=h[1],p=function(e){f(Object(o.a)(Object(o.a)({},m),{},Object(J.a)({},e.target.name,e.target.value)))};return Object(j.jsxs)(j.Fragment,{children:[0===r.length&&Object(j.jsx)(l.a,{to:"/"}),t&&Object(j.jsx)(x,{}),Object(j.jsxs)("div",{children:[Object(j.jsx)("h2",{children:"Complete sus datos"}),Object(j.jsx)("hr",{}),Object(j.jsx)("div",{className:"container my-5",children:Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),m.nombre.length<3?alert("Nombre inv\xe1lido"):m.apellido.length<3?alert("Apellido inv\xe1lido"):m.email.length<3?alert("Email inv\xe1lido"):m.tel.length<7?alert("Tel\xe9fono inv\xe1lido"):(c(!0),function(e,t,c){return new Promise(function(){var n=Object(K.a)(G.a.mark((function n(a,r){var i,s,l,j,d,b,u;return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={buyer:e,items:t.map((function(e){return{id:e.id,precio:e.price,cantidad:e.cantidad}})),total:c,date:Z.a.firestore.Timestamp.fromDate(new Date)},s=O(),l=s.collection("orders"),j=s.collection("productos").where(Z.a.firestore.FieldPath.documentId(),"in",t.map((function(e){return e.id}))),n.next=6,j.get();case 6:d=n.sent,b=s.batch(),u=[],d.docs.forEach((function(e){var c=t.find((function(t){return t.id===e.id}));e.data().stock>=c.cantidad?b.update(e.ref,{stock:e.data().stock-c.cantidad}):u.push(Object(o.a)(Object(o.a)({},e.data()),{},{id:e.id}))})),0===u.length?l.add(i).then((function(e){b.commit(),a(e.id)})):r(u);case 11:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}(m,r,i()).then((function(e){V.a.fire({icon:"success",title:"Orden registrada!",text:"Guarde su n\xfamero: ".concat(e),willClose:function(){b()}})})).catch((function(e){V.a.fire({icon:"error",title:"Productos sin stock",text:"No hay stock de: ".concat(e.map((function(e){return e.name})).join(", "))})})).finally((function(){c(!1)})))},children:[Object(j.jsx)("h2",{children:"Formulario"}),Object(j.jsx)("input",{className:"form-control my-2",type:"text",placeholder:"Nombre",name:"nombre",value:m.nombre,onChange:p}),0===m.nombre.length&&Object(j.jsx)("small",{children:"Este campo es obligatorio"}),Object(j.jsx)("input",{className:"form-control my-2",type:"text",placeholder:"Apellido",name:"apellido",value:m.apellido,onChange:p}),0===m.apellido.length&&Object(j.jsx)("small",{children:"Este campo es obligatorio"}),Object(j.jsx)("input",{className:"form-control my-2",type:"email",placeholder:"Email",name:"email",value:m.email,onChange:p}),0===m.email.length&&Object(j.jsx)("small",{children:"Este campo es obligatorio"}),Object(j.jsx)("input",{className:"form-control my-2",type:"tel",placeholder:"Tel\xe9fono",name:"tel",value:m.tel,onChange:p}),0===m.tel.length&&Object(j.jsx)("small",{children:"Este campo es obligatorio"}),Object(j.jsx)("button",{className:"btn btn-success",type:"submit",disabled:t,children:"Finalizar"})]})})]})]})};var M=function(){var e=Object(n.useContext)(P).isAuthenticated;return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(b,{children:Object(j.jsx)(I,{children:Object(j.jsxs)(p.a,{children:[Object(j.jsx)(L,{logo:"Proyecto Profe"}),Object(j.jsx)(l.d,{children:e?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(l.b,{exact:!0,path:"/",children:Object(j.jsx)(C,{})}),Object(j.jsx)(l.b,{exact:!0,path:"/productos/:categoryId",children:Object(j.jsx)(C,{})}),Object(j.jsx)(l.b,{exact:!0,path:"/detail/:itemId",children:Object(j.jsx)(w,{})}),Object(j.jsx)(l.b,{exact:!0,path:"/contacto",children:Object(j.jsx)("h1",{children:"Contacto"})}),Object(j.jsx)(l.b,{exact:!0,path:"/cart",children:Object(j.jsx)(B,{})}),Object(j.jsx)(l.b,{exact:!0,path:"/checkout",children:Object(j.jsx)(q,{})}),Object(j.jsx)(l.b,{path:"*",children:Object(j.jsx)(l.a,{to:"/"})})]}):Object(j.jsx)(D,{})})]})})})})},Q=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,84)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;c(e),n(e),a(e),r(e),i(e)}))};i.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(A,{children:Object(j.jsx)(M,{})})}),document.getElementById("root")),Q()}},[[80,1,2]]]);
//# sourceMappingURL=main.feb45b61.chunk.js.map